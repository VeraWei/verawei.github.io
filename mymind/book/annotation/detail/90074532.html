<!DOCTYPE html><html lang="zh-cmn-Hans" class=" book-new-nav"><head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <title>
    Get Out of Your Mind and Into Your Life
</title>
  
<script>!function(e){var o=function(o,n,t){var c,i,r=new Date;n=n||30,t=t||"/",r.setTime(r.getTime()+24*n*60*60*1e3),c="; expires="+r.toGMTString();for(i in o)e.cookie=i+"="+o[i]+c+"; path="+t},n=function(o){var n,t,c,i=o+"=",r=e.cookie.split(";");for(t=0,c=r.length;t<c;t++)if(n=r[t].replace(/^\s+|\s+$/g,""),0==n.indexOf(i))return n.substring(i.length,n.length).replace(/\"/g,"");return null},t=e.write,c={"douban.com":1,"douban.fm":1,"google.com":1,"google.cn":1,"googleapis.com":1,"gmaptiles.co.kr":1,"gstatic.com":1,"gstatic.cn":1,"google-analytics.com":1,"googleadservices.com":1},i=function(e,o){var n=new Image;n.onload=function(){},n.src="https://www.douban.com/j/except_report?kind=ra022&reason="+encodeURIComponent(e)+"&environment="+encodeURIComponent(o)},r=function(o){try{t.call(e,o)}catch(e){t(o)}},a=/<script.*?src\=["']?([^"'\s>]+)/gi,g=/http:\/\/(.+?)\.([^\/]+).+/i;e.writeln=e.write=function(e){var t,l=a.exec(e);return l&&(t=g.exec(l[1]))?c[t[2]]?void r(e):void("tqs"!==n("hj")&&(i(l[1],location.href),o({hj:"tqs"},1),setTimeout(function(){location.replace(location.href)},50))):void r(e)}}(document);</script>

  
  <meta http-equiv="Pragma" content="no-cache">
  <meta http-equiv="Expires" content="Sun, 6 Mar 2005 01:00:00 GMT">
  
  <script>var _head_start = new Date();</script>
  
  <link href="https://img9.doubanio.com/f/book/4cc1d754ffe6fbd776215e84f222dcb2a4265882/css/book/master.css" rel="stylesheet" type="text/css">

  <link href="https://img9.doubanio.com/f/book/222a5c61e041638af8defc87cf97f4a863a77922/css/book/base/init.css" rel="stylesheet">
  <style type="text/css">
  [data-like]{display:inline-block}[data-like] .LikeTagsDialog{right:auto;left:-10px}[data-like] .LikeTagsDialog:after{right:auto;left:25px}.reading-notes{overflow:visible}.reading-notes .ctsh .clst,.reading-notes .comments .con .reading-note{overflow:visible}

.rnote { margin-bottom: 15px }
.rnote .info { border-bottom: 1px dashed #ddd; padding: 0 0 10px 0 }
.rnote .rec-sec { float: right }
.rnote pre { margin-bottom:1.5em;font:12px/162% Arial,Helvetica,sans-serif; white-space: pre-wrap; word-wrap: break-word }
.aside blockquote { margin: 0; width: 20px; float: left; padding: 0; background-position: 0 50% }
.aside blockquote q { padding-right: 10px }

.aside .new-annotation {
  height: 24px;
  line-height: 24px;
  vertical: bottom;
}

.aside .new-annotation,
.annotation-promo {
  margin-bottom: 20px;
}
.annotation-promo a:hover,
.annotation-promo a {
  display: block;
  width: 100%;
  height: 50px;
  line-height: 50px;
  vertical-align: bottom;
  background: url(/pics/book/annotation/ios/promo.png) no-repeat -3px 0px;
  text-indent: -9999px;
}

.aside .disclaimer {
  margin-bottom: 40px;
}
</style>
  <script src="https://img9.doubanio.com/f/book/0495cb173e298c28593766009c7b0a953246c5b5/js/book/lib/jquery/jquery.js"></script>
  <script src="https://img9.doubanio.com/f/shire/22ee83f45f94c7a90e73e0ee4acd18f902a6991f/js/douban.js"></script>
  <script src="https://img9.doubanio.com/f/book/0322e3e810e475f1c82adb7d1c6ccfa1c0fa969c/js/book/master.js"></script>
  

  
  <meta name="mobile-agent" content="format=html5; url=https://m.douban.com/book/annotation/90074532">
  <link href="https://img9.doubanio.com/f/book/8d88a11c4dd76aef91ed41aee85e58eeb757dc59/css/book/notes.css" type="text/css" rel="stylesheet">
  <link href="https://img9.doubanio.com/f/shire/b6814ac068f705a1366083b58858a468706a60dc/css/lib/jquery.snippet.css" type="text/css" rel="stylesheet">
  <link href="https://img9.doubanio.com/f/shire/8377b9498330a2e6f056d863987cc7a37eb4d486/css/ui/dialog.css" type="text/css" rel="stylesheet">
  <script src="https://img9.doubanio.com/f/shire/2c0c1c6b83f9a457b0f38c38a32fc43a42ec9bad/js/do.js" data-cfg-autoload="false"></script>
  <script type="text/javascript" src="https://img9.doubanio.com/f/shire/7965e09b0065d26bfd22d390de956c22a48b9008/js/lib/jquery.snippet.js"></script>
  <link type="text/css" href="https://img9.doubanio.com/f/shire/ce3ccd609585055eee51d0226a7c6bbe5563454a/css/lib/jquery.ui.tooltip.css" rel="stylesheet">
  <script type="text/javascript" src="https://img9.doubanio.com/f/shire/e254005edae24d9a1808ede9c3d7fcc5b6d94e1b/js/lib/jquery.ui.min.js"></script>
  <script type="text/javascript" src="https://img9.doubanio.com/f/shire/5a2413f37f7e0bb326a611cc86f85886f4dc6a97/js/lib/jquery.ui.tooltip.js"></script>
  <script type="text/javascript" src="https://img9.doubanio.com/f/book/26ffd675884db883de565c9a5c9ffdf167ab55c5/js/book/pos_fixed.js"></script>
  <script type="text/javascript">
    $(function () {
      $().fixSide(350, 52)
    })
  </script>
  <script type="text/x-mathjax-config">
MathJax.Hub.Config({
	jax: ["input/TeX", "output/HTML-CSS"],
    extensions: ["tex2jax.js","TeX/AMSmath.js","TeX/AMSsymbols.js","TeX/noUndefined.js"],
    tex2jax: {
		inlineMath: [ ["($", "$)"], ['\\(','\\)'] ],
		displayMath: [ ["($$","$$)"], ['\\[','\\]']],
		skipTags: ["script","noscript","style","textarea"],
		processEscapes: true,
		processEnvironments: true,
		preview: "TeX"
	},
	showProcessingMessages: false
  });
</script>

  <script type="text/javascript" src="https://img9.doubanio.com/f/shire/bc881a837a728ab82aa01d653b1c180190bb5a5d/js/ui/dialog.js"></script>

  <script>  </script>
  <link rel="stylesheet" href="https://img9.doubanio.com/misc/mixed_static/6c667518cf30844a.css">

  <link rel="shortcut icon" href="https://img9.doubanio.com/favicon.ico" type="image/x-icon">
</head>
<body>
  
    <script>var _body_start = new Date();</script>
    
  



    <link href="//img3.doubanio.com/dae/accounts/resources/f55e154/shire/bundle.css" rel="stylesheet" type="text/css">




<script>
  ;window._GLOBAL_NAV = {
    USER_ID: "252269522",
    UPLOAD_AUTH_TOKEN: "252269522:8c1620a4e405d8238e6020df6ec9920a71d914dd",
    SSE_TOKEN: "a254b1705031d44807d249c52f75c6dcaa602f3e",
    SSE_TIMESTAMP: "1640990625",
    DOUBAN_URL: "https://www.douban.com",
    N_NEW_NOTIS: 0,
    N_NEW_DOUMAIL: 0
  };
</script>



    <script src="//img3.doubanio.com/dae/accounts/resources/f55e154/shire/bundle.js" defer="defer"></script>




  



    <link href="//img3.doubanio.com/dae/accounts/resources/f55e154/book/bundle.css" rel="stylesheet" type="text/css">






<script id="suggResult" type="text/x-jquery-tmpl">
  <li data-link="{{= url}}">
            <a href="{{= url}}" onclick="moreurl(this, {from:'book_search_sugg', query:'{{= keyword }}', subject_id:'{{= id}}', i: '{{= index}}', type: '{{= type}}'})">
            <img src="{{= pic}}" width="40" />
            <div>
                <em>{{= title}}</em>
                {{if year}}
                    <span>{{= year}}</span>
                {{/if}}
                <p>
                {{if type == "b"}}
                    {{= author_name}}
                {{else type == "a" }}
                    {{if en_name}}
                        {{= en_name}}
                    {{/if}}
                {{/if}}
                 </p>
            </div>
        </a>
        </li>
  </script>




    <script src="//img3.doubanio.com/dae/accounts/resources/f55e154/book/bundle.js" defer="defer"></script>





    <div id="wrapper">
        
        
  <div id="content">
    
    <h1>Get Out of Your Mind and Into Your Life</h1>

    <div class="grid-16-8 clearfix">
      
      <div class="article">



<div class="mod profile clearfix">
    
    <div class="info">
        <h6><a href="javascript:void(0)">ç§‹æ˜</a>
          <span class="">(å†°ç«ä¸¤é‡å¤©)</span>
        </h6>
        <p><span class="stat">è¯»è¿‡</span> <a class="name" href="javascript:void(0)">Get Out of Your Mind and Into Your Life</a>
          <span class="rating5-t"></span>
        </p>
    </div>
</div>







<div class="mod rnote">
    <div class="bd clearfix">
        <div class="annotation-info">
          <ul>
            <li>
                <span class="pubtime">2019-12-10 07:45:38</span>
            </li>
          </ul>
        </div>
        <pre id="link-report" class=""><p data-page="0">We can be afraid of negative evaluations from others, even if we havenâ€™t ever experienced them, and we can become socially inhibited as a result.</p><p data-page="0">In normal problem-solving situations, when since there is something we donâ€™t like, we figure out how to get rid of it and we take actions to do that.</p><p data-page="0">Thought suppression only makes the situation worse.</p><p data-page="0">Anxiety is a normal response to poor performance, or humiliation. The problem is that we can bring these consequences into the current situation at any moment through verbal relations.</p><p data-page="0">You try to avoid the experience of painful thoughts or feelings by burying yourself in distracting activities, combating your thoughts with rationalizations, or trying to quash your feelings through the use of controlled substances. If you are suffering, you may spend a lot of time performing these distracting coping techniques. Meanwhile, your life is not being lived.</p><p data-page="0">When we try to run away from a painful thought, feeling, or bodily sensation, it becomes more important and tends to occur more intensely or frequently. Because running away also means that we are taking our fearful thoughts literally, they become more believable and entangling. As a result, the â€œpain of presenceâ€ grows. As a result, the â€œpain of absenceâ€ grows as well. The black spot in the middle grows bigger and bigger.</p><p data-page="0">Living in your mind can be likened to riding a train. A train has its own tracks and it goes where they lead. Thatâ€™s fine when the tracks are going where you want to go. But if you were traveling in the direction you want to be going, you probably would never have stopped to read this book. If the life you want to live is â€œoff the tracksâ€, then you have only one option: you must learn how to get off the trainâ€¦ at least sometimes.</p><p data-page="0">To know what an experience is really like, youâ€™ve got to experience it for yourself, not just think about it. To see what itâ€™s like to jump off the mind-train, you have to actually do it. You do that by breaking some of the rules and conditions your mind sets for you.</p><p data-page="0">The situation you are in now may feel like being in a tug-of-war with a big, ugly monster (whether you are dealing with depression, anxiety, physical pain, sorrowful memories, or some other negative situation). It seems as though you canâ€™t win. The harder you pull, the harder the monster pulls back.</p><p data-page="0">When you are applauded for your accomplishments, you may feel as though you are fooling others because you know what is really going on for you beneath your calm appearance.</p><p data-page="0">You are likely to feel an immediate sense of relief from not having to deal with the painful thought, feeling, or bodily sensation. The sense of relief you gain reinforces your desire to use the same strategy the next time you are faced with your pain. Yet, each time you do this, you actually give the painful content, that is, your painful thought, feeling, or bodily sensation, more power.</p><p data-page="0">If you let go of the struggle, the more freedom you have to make new choices.</p><p data-page="0">So, What are you supposed to do?</p><p data-page="0">First, give yourself a break;</p><p data-page="0">Second, accept response-ability;</p><p data-page="0">Third, begin to consider the possibility that there is a real alternative to your struggle;</p><p data-page="0">Forth, make room for the possibility that alternative to control is frustrating subtle;</p><p data-page="0">  Letting go of control does not require a lot of effort. But letting go of control( where control does not belong)
</p><p data-page="0">Is tricky. It is confusing. It can be frustrating. This is not something the â€œword machineâ€ that is your mind is accustomed to doing.</p><p data-page="0">MOVING ON</p><p data-page="0">Before you can move on with your life, you need to look directly at where you presently are.</p><p data-page="0">To be willing and accepting means noticing that you are the sky, not they clouds; the ocean, not the waves. It means noticing that you are large enough to contain all of your experiences, just as the sky can contain any cloud and the ocean any wave.</p><p data-page="0">History is very easy to create.</p><p data-page="0">Say it in a different voice.</p><p data-page="0">Being able to distinguish between descriptions and evaluations should allow you the freedom to recognize when your mind is recording or noticing your actual experience and when it is making its own judgement calls on that experience.</p><p data-page="0">Have you ever noticed that if someone thinks he is unimportant, most events in his life appear to confirm that view?</p><p data-page="0">Have you ever observed that if someone sees herself as a victim, somehow she keeps ending up (in her mind or in actuality) being victimized?</p><p data-page="0">Chronic emotional avoiders do not know what they are feeling because not knowing is itself a powerful form of avoidance.</p><p data-page="0">A person who is supposedly â€œalways helpful and sweetâ€ will have a hard time admitting to feelings or thoughts that are angry, jealous, or resentful as they emerge in the present moment.</p><p data-page="0">This is an interesting exercise that may provide insight into the way you can focus your attention on specific aspects of complex sets of stimuli, concentrate on several things at the same time, or simply allow all of your experience to become wrapped up in one flowing song.</p><p data-page="0">Values are verbs and adverbs, not nouns or adjectives; they are something you do or a quality of something you do, not something you have.</p><p data-page="0">Values , however are anything but meaningless. So the chatter will be louder, and the reasons will be stronger. But the action will be the same. We can be about anything we want to be about. Who can stop us?</p><p data-page="0">Feelings are not something you can control, while choosing a direction is something you can control.</p><p data-page="0">You cannot value anything without being woundable, indeed, your values are the most intimate part of you.</p><p data-page="0">Values are directions, not outcomes.</p><p data-page="0">Different journeys require different maps.</p></pre>
        
    <style>
        #link-report .report { text-align: right; font-size: 12px; visibility: hidden; }
        #link-report .report a { color: #BBB; }
        #link-report .report a:hover { color: #FFF; background-color: #BBB; }
      
.dui-dialog { position:fixed;_position:absolute;z-index:1000; }
.dui-dialog .dui-dialog-content {
  position: relative;
  z-index: 2;
  background: #fff;
  border: 1px solid #bbb;
  -moz-border-radius: 4px;
  border-radius: 4px;
  *zoom: 1;
}
.dui-dialog .hd {
  padding: 10px 10px 6px;
  background: #ebf5eb;
  font-size: 14px;
  -moz-border-radius: 4px;
  border-radius: 4px 4px 0 0;
}
.dui-dialog .hd h3 { padding:0 40px 0 4px;background:none;color:#060; }
.dui-dialog .hd h3 i { color:#060;font-style:normal;margin-left:0.5ex; }
.dui-dialog .bd { position:relative; padding:15px;*zoom:1;font-size:12px;}
.dui-dialog .bd:after { content:&#39;\0020&#39;;clear:both;display:block; }
.dui-dialog .ft .bn-flat,
.dui-dialog .ft input { margin:0 .5em; }
.dui-dialog .ft { text-align:center;padding:10px;padding-top:0; }
.dui-dialog .dui-dialog-close {
  position: absolute;
  top: 10px;
  right: 12px;
  padding: 0 3px;
  z-index: 1;
  font: 11px/1.2 &#34;Comic Sans MS&#34;, sans-serif;
}
a.dui-dialog-close:link { color:#b4b4b4; }
a.dui-dialog-close:hover {color: #fab0b6; background:none; }
.dui-dialog .dui-dialog-shd {
    position:absolute;
    left:-8px;
    top:-8px;
    width:100%;
    height:100%;
    padding:8px;
    background:#666;
    opacity:.4;
    filter:alpha(opacity=50);
    -ms-filter:&#34;alpha(opacity=50)&#34;;
    -moz-border-radius:5px;
    -webkit-border-radius:5px;
    border-radius:5px;
}
.dui-dialog-iframe { border:0;background:transparent;position:absolute;z-index:1;left:-8px;top:-8px;opacity:0;filter:alpha(opacity=0); }
.dui-dialog-msk {
    background:#fff;
    position:absolute;
    width: 100%;
    z-index:999;
    left:0;
    top:0;
    opacity:0.7;
    filter:alpha(opacity=70);
}


    </style>
  <script type="text/javascript" src="https://img9.doubanio.com/f/shire/bc7a779ea587a4a077edb3b6121316f65febbd13/js/report_dialog.js"></script>
  <link rel="stylesheet" type="text/css" href="https://img9.doubanio.com/f/shire/23ff197799d608be56df5dfefb4974fa33f4579b/css/report_dialog.css">
    <script>
        Do = (typeof Do === 'undefined')? $ : Do;
        Do(function(){
          var reportDiv = "#link-report".concat("");
          $("body").delegate(reportDiv, 'mouseenter mouseleave', function(e){

            switch (e.type) {
              case "mouseenter":
                $(this).find(".report").css('visibility', 'visible');
                break;
              case "mouseleave":
                $(this).find(".report").css('visibility', 'hidden');
                break;
            }
          });
          $(reportDiv).delegate(".report a", 'click', function(e){
              e.preventDefault();
              var opt = "";
              var obj = $(e.target).closest(reportDiv);
              var id = obj.length != 0 ? obj.data("id") : undefined;
              var params = (opt&&id) ? '?'.concat(opt, '=', id) : '';
              var url = "https://book.douban.com/annotation/90074532/".concat(params);
              generate_report_dialog({report_url: url});
          });

          $(reportDiv).append('<div class="report"><a rel="nofollow" href="#">æŠ•è¯‰</a></div>');
      });
    </script>

        <div class="pl info" style="margin: 1em 0;">
              <span class="">5äººé˜…è¯»</span>
        </div>
            <div style="text-align: right">
              
    
    
    <div class="action-react">
            <a href="javascript:void(0)" data-type="annotation" class=" react-like react-btn" data-reaction_type="0" data-object_id="90074532">
                <span class="react-text">èµ</span>
                <span class="react-num">1</span>
            </a>
    </div>

    

              





<div class="action-collect">
    <a href="javascript:void(0)" data-id="90074532" data-cate="3049" data-canview="True" data-url="https://book.douban.com/annotation/90074532/" data-catename="" data-link="https://www.douban.com/people/252269522/doulists/all?add=90074532&amp;cat=3049" data-title="Get Out of Your Mind and Into Your Life" data-picture="https://img9.doubanio.com/f/shire/a28ac64f34a48acd8d058b67be0be50a3d6315f3/pics/doulist_article.png" class="lnk-doulist-add collect-add" onclick="moreurl(this, { 'from':'doulist-btn-3049-90074532-252269522'})">
        <span class="react-text">æ”¶è—</span>
        <span class="react-num"></span>
    </a>
</div>

              
    

    

    

    <div class="sharing" data-target="{&quot;url&quot;: &quot;https://book.douban.com/annotation/90074532/&quot;, &quot;desc&quot;: &quot;We can be afraid of negative evaluations from others, even if we haven\u2019t ever experienced them, and we can become socially inhibited as a result. In normal problem-solving situ...&quot;, &quot;pic&quot;: &quot;&quot;, &quot;title&quot;: &quot;Get Out of Your Mind and Into Your Life&quot;}">

        <div class="sharing-button">
            <div class="sharing-douban">
                
    

        
            
        

        <div class="rec-sec">


    <span class="rec">
        
            <a data-user_id="252269522" href="javascript:void(0)" share-id="90074532" data-mode="plain" data-name="Get Out of Your Mind and Into Your Life" data-type="com.douban.book" data-desc="We can be afraid of negative evaluations from others, even if we havenâ€™t ever experienced them, and we can become socially inhibited as a result. In normal problem-solving situ..." data-href="https://book.douban.com/annotation/90074532/" data-image="" data-properties="{&quot;href&quot;:&quot;https:\/\/www.douban.com\/people\/nothinganymore\/&quot;,&quot;name&quot;:&quot;ç§‹æ˜&quot;,&quot;uid&quot;:&quot;78857574&quot;}" data-redir="https://book.douban.com/annotation/90074532/vote?ck=nTrr" data-text="" data-apikey="" data-curl="" data-count="10" data-object_kind="3049" data-object_id="90074532" data-target_type="rec" data-target_action="0" data-action_props="{&quot;subject_url&quot;:&quot;https:\/\/book.douban.com\/subject\/1498677\/&quot;,&quot;note_url&quot;:&quot;https:\/\/book.douban.com\/annotation\/90074532\/&quot;,&quot;author_name&quot;:&quot;ç§‹æ˜&quot;,&quot;subject_title&quot;:&quot;Get Out of Your Mind and Into Your Life&quot;,&quot;note_title&quot;:&quot;Get Out of Your Mind and Into Your Life&quot;}" data-btn_text="è½¬å‘" data-heading="è½¬å‘åˆ°è±†ç“£" data-sanity_key="_2804d" class="lnk-sharing lnk-douban-sharing">
                    
                            è½¬å‘
                    
            </a>
    </span>


    </div>

            </div>
        </div>


        
    </div>


            </div>
    </div>
</div>











<script>
    var _COMMENTS_CONFIG = {
        'service': 'annotation',
        'app': 'book',
        'api': '/j/annotation',
        'api_report': 'https://www.douban.com/misc/audit_report',
        'comments': [{"is_folded":false,"has_ref":false,"ref_comment":null,"from":["è±†ç“£App","https:\/\/www.douban.com\/doubanapp\/"],"author":{"kind":1000,"name":"[å·²æ³¨é”€]","url":"https:\/\/www.douban.com\/people\/season-of-mine\/","gender":"F","abstract":"","avatar":"https://img9.doubanio.com\/icon\/user_normal_f.jpg","signature":"","id":"16719047","uid":"season-of-mine"},"text":"èµï¼ï¼ˆä½†æ˜¯æœ‰ç‚¹å¿ƒçµé¸¡æ±¤","total_replies":0,"entities":{"user_mentions":[],"topics":[],"urls":[],"subject_links":[]},"create_time":"2019-12-10 09:50:52","replies":[],"is_deleted":false,"id":"327228"},{"is_folded":false,"has_ref":false,"ref_comment":null,"from":["è±†ç“£App","https:\/\/www.douban.com\/doubanapp\/"],"author":{"kind":1000,"name":"[å·²æ³¨é”€]","url":"https:\/\/www.douban.com\/people\/season-of-mine\/","gender":"F","abstract":"","avatar":"https://img9.doubanio.com\/icon\/user_normal_f.jpg","signature":"","id":"16719047","uid":"season-of-mine"},"text":"ä½†ï¼Œæˆ‘å–œæ¬¢é¸¡æ±¤ï¼","total_replies":1,"entities":{"user_mentions":[],"topics":[],"urls":[],"subject_links":[]},"create_time":"2019-12-10 09:51:25","replies":[{"is_folded":false,"has_ref":true,"ref_comment":{"is_folded":false,"has_ref":false,"ref_comment":null,"from":["è±†ç“£App","https:\/\/www.douban.com\/doubanapp\/"],"author":{"kind":1000,"name":"[å·²æ³¨é”€]","url":"https:\/\/www.douban.com\/people\/season-of-mine\/","gender":"F","abstract":"","avatar":"https://img9.doubanio.com\/icon\/user_normal_f.jpg","signature":"","id":"16719047","uid":"season-of-mine"},"text":"ä½†ï¼Œæˆ‘å–œæ¬¢é¸¡æ±¤ï¼","total_replies":1,"entities":{"user_mentions":[],"topics":[],"urls":[],"subject_links":[]},"create_time":"2019-12-10 09:51:25","replies":[],"is_deleted":false,"id":"327229"},"from":["è±†ç“£App","https:\/\/www.douban.com\/doubanapp\/"],"author":{"kind":1000,"name":"ç§‹æ˜","url":"https:\/\/www.douban.com\/people\/nothinganymore\/","gender":"F","abstract":"So even if it feels like the whole world is against you, having just one person on your side can make a big difference.\n\nHey, ä¸ç®¡æˆ‘ä»¬è®¤ä¸è®¤è¯†ï¼Œå¦‚æœä½ çœ‹åˆ°è¿™å¥è¯äº†ï¼Œé‚£æˆ‘å¸Œæœ›ä½ çŸ¥é“ï¼Œä½ å·²ç»è¶³å¤Ÿå¥½äº†å‘€ï¼","avatar":"https://img9.doubanio.com\/icon\/up78857574-10.jpg","signature":"å†°ç«ä¸¤é‡å¤©","id":"78857574","uid":"nothinganymore"},"text":"é¸¡æ±¤è¡¥è¡€ï¼Œå“ˆå“ˆå“ˆ","total_replies":0,"entities":{"user_mentions":[],"topics":[],"urls":[],"subject_links":[]},"create_time":"2019-12-10 10:09:42","replies":[],"is_deleted":false,"id":"327230"}],"is_deleted":false,"id":"327229"},{"is_folded":false,"has_ref":false,"ref_comment":null,"from":"","author":{"kind":1000,"name":"å²æœˆå¦‚æ¢­","url":"https:\/\/www.douban.com\/people\/Cyprus0903\/","gender":"F","abstract":"","avatar":"https://img9.doubanio.com\/icon\/up55998056-2.jpg","signature":"","id":"55998056","uid":"Cyprus0903"},"text":"æ ¼å¼åŒ–å‘€ï¼Œå¤§å“¥ï¼Œè¿™æ ·ä¸€å¤§æ®µï¼Œå¥½æœ‰å‹åŠ›","total_replies":1,"entities":{"user_mentions":[],"topics":[],"urls":[],"subject_links":[]},"create_time":"2019-12-13 15:18:19","replies":[{"is_folded":false,"has_ref":true,"ref_comment":{"is_folded":false,"has_ref":false,"ref_comment":null,"from":"","author":{"kind":1000,"name":"å²æœˆå¦‚æ¢­","url":"https:\/\/www.douban.com\/people\/Cyprus0903\/","gender":"F","abstract":"","avatar":"https://img9.doubanio.com\/icon\/up55998056-2.jpg","signature":"","id":"55998056","uid":"Cyprus0903"},"text":"æ ¼å¼åŒ–å‘€ï¼Œå¤§å“¥ï¼Œè¿™æ ·ä¸€å¤§æ®µï¼Œå¥½æœ‰å‹åŠ›","total_replies":1,"entities":{"user_mentions":[],"topics":[],"urls":[],"subject_links":[]},"create_time":"2019-12-13 15:18:19","replies":[],"is_deleted":false,"id":"327417"},"from":["è±†ç“£App","https:\/\/www.douban.com\/doubanapp\/"],"author":{"kind":1000,"name":"ç§‹æ˜","url":"https:\/\/www.douban.com\/people\/nothinganymore\/","gender":"F","abstract":"So even if it feels like the whole world is against you, having just one person on your side can make a big difference.\n\nHey, ä¸ç®¡æˆ‘ä»¬è®¤ä¸è®¤è¯†ï¼Œå¦‚æœä½ çœ‹åˆ°è¿™å¥è¯äº†ï¼Œé‚£æˆ‘å¸Œæœ›ä½ çŸ¥é“ï¼Œä½ å·²ç»è¶³å¤Ÿå¥½äº†å‘€ï¼","avatar":"https://img9.doubanio.com\/icon\/up78857574-10.jpg","signature":"å†°ç«ä¸¤é‡å¤©","id":"78857574","uid":"nothinganymore"},"text":"å’‹æ ¼ï¼ŸåŠ ä¸ªç²—ï¼Ÿæ ¼å®Œäº†è¿˜æ˜¯ä¸€å¤§æ®µå‘€ğŸ˜‚","total_replies":0,"entities":{"user_mentions":[],"topics":[],"urls":[],"subject_links":[]},"create_time":"2019-12-14 00:34:38","replies":[],"is_deleted":false,"id":"327493"}],"is_deleted":false,"id":"327417"},{"is_folded":false,"has_ref":false,"ref_comment":null,"from":["è±†ç“£App","https:\/\/www.douban.com\/doubanapp\/"],"author":{"kind":1000,"name":"æ‚ æ€¡ç„¶","url":"https:\/\/www.douban.com\/people\/33912666\/","gender":null,"abstract":"æ‰¾åˆ°è‡ªå·±çš„è·¯ã€‚","avatar":"https://img9.doubanio.com\/icon\/up33912666-6.jpg","signature":"","id":"33912666","uid":"33912666"},"text":"æœ‹å‹ä½ å¥½ï¼Œè¯·é—®ä½ æ˜¯è´­ä¹°çš„çº¸ä¹¦è¿˜æ˜¯æœ‰pdfå‘€ï¼Ÿæˆ‘æƒ³è¯»å¯æ˜¯ä¸çŸ¥é“ä»å“ªé‡Œæ‰¾è‹±æ–‡ç‰ˆã€‚","total_replies":4,"entities":{"user_mentions":[],"topics":[],"urls":[],"subject_links":[]},"create_time":"2020-03-24 18:44:49","replies":[{"is_folded":false,"has_ref":true,"ref_comment":{"is_folded":false,"has_ref":false,"ref_comment":null,"from":["è±†ç“£App","https:\/\/www.douban.com\/doubanapp\/"],"author":{"kind":1000,"name":"æ‚ æ€¡ç„¶","url":"https:\/\/www.douban.com\/people\/33912666\/","gender":null,"abstract":"æ‰¾åˆ°è‡ªå·±çš„è·¯ã€‚","avatar":"https://img9.doubanio.com\/icon\/up33912666-6.jpg","signature":"","id":"33912666","uid":"33912666"},"text":"æœ‹å‹ä½ å¥½ï¼Œè¯·é—®ä½ æ˜¯è´­ä¹°çš„çº¸ä¹¦è¿˜æ˜¯æœ‰pdfå‘€ï¼Ÿæˆ‘æƒ³è¯»å¯æ˜¯ä¸çŸ¥é“ä»å“ªé‡Œæ‰¾è‹±æ–‡ç‰ˆã€‚","total_replies":4,"entities":{"user_mentions":[],"topics":[],"urls":[],"subject_links":[]},"create_time":"2020-03-24 18:44:49","replies":[],"is_deleted":false,"id":"336908"},"from":["è±†ç“£App","https:\/\/www.douban.com\/doubanapp\/"],"author":{"kind":1000,"name":"ç§‹æ˜","url":"https:\/\/www.douban.com\/people\/nothinganymore\/","gender":"F","abstract":"So even if it feels like the whole world is against you, having just one person on your side can make a big difference.\n\nHey, ä¸ç®¡æˆ‘ä»¬è®¤ä¸è®¤è¯†ï¼Œå¦‚æœä½ çœ‹åˆ°è¿™å¥è¯äº†ï¼Œé‚£æˆ‘å¸Œæœ›ä½ çŸ¥é“ï¼Œä½ å·²ç»è¶³å¤Ÿå¥½äº†å‘€ï¼","avatar":"https://img9.doubanio.com\/icon\/up78857574-10.jpg","signature":"å†°ç«ä¸¤é‡å¤©","id":"78857574","uid":"nothinganymore"},"text":"æˆ‘æ˜¯åœ¨jiumo.comä¸Šä¸‹è½½çœ‹çš„ï¼Œåº”è¯¥æœ‰çš„","total_replies":0,"entities":{"user_mentions":[],"topics":[],"urls":[],"subject_links":[]},"create_time":"2020-03-24 20:38:46","replies":[],"is_deleted":false,"id":"336914"},{"is_folded":false,"has_ref":true,"ref_comment":{"is_folded":false,"has_ref":true,"ref_comment":null,"from":["è±†ç“£App","https:\/\/www.douban.com\/doubanapp\/"],"author":{"kind":1000,"name":"ç§‹æ˜","url":"https:\/\/www.douban.com\/people\/nothinganymore\/","gender":"F","abstract":"So even if it feels like the whole world is against you, having just one person on your side can make a big difference.\n\nHey, ä¸ç®¡æˆ‘ä»¬è®¤ä¸è®¤è¯†ï¼Œå¦‚æœä½ çœ‹åˆ°è¿™å¥è¯äº†ï¼Œé‚£æˆ‘å¸Œæœ›ä½ çŸ¥é“ï¼Œä½ å·²ç»è¶³å¤Ÿå¥½äº†å‘€ï¼","avatar":"https://img9.doubanio.com\/icon\/up78857574-10.jpg","signature":"å†°ç«ä¸¤é‡å¤©","id":"78857574","uid":"nothinganymore"},"text":"æˆ‘æ˜¯åœ¨jiumo.comä¸Šä¸‹è½½çœ‹çš„ï¼Œåº”è¯¥æœ‰çš„","total_replies":1,"entities":{"user_mentions":[],"topics":[],"urls":[],"subject_links":[]},"create_time":"2020-03-24 20:38:46","replies":[],"is_deleted":false,"id":"336914"},"from":["è±†ç“£App","https:\/\/www.douban.com\/doubanapp\/"],"author":{"kind":1000,"name":"æ‚ æ€¡ç„¶","url":"https:\/\/www.douban.com\/people\/33912666\/","gender":null,"abstract":"æ‰¾åˆ°è‡ªå·±çš„è·¯ã€‚","avatar":"https://img9.doubanio.com\/icon\/up33912666-6.jpg","signature":"","id":"33912666","uid":"33912666"},"text":"è°¢å•¦","total_replies":0,"entities":{"user_mentions":[],"topics":[],"urls":[],"subject_links":[]},"create_time":"2020-03-24 20:41:58","replies":[],"is_deleted":false,"id":"336915"},{"is_folded":false,"has_ref":true,"ref_comment":{"is_folded":false,"has_ref":true,"ref_comment":null,"from":["è±†ç“£App","https:\/\/www.douban.com\/doubanapp\/"],"author":{"kind":1000,"name":"æ‚ æ€¡ç„¶","url":"https:\/\/www.douban.com\/people\/33912666\/","gender":null,"abstract":"æ‰¾åˆ°è‡ªå·±çš„è·¯ã€‚","avatar":"https://img9.doubanio.com\/icon\/up33912666-6.jpg","signature":"","id":"33912666","uid":"33912666"},"text":"è°¢å•¦","total_replies":1,"entities":{"user_mentions":[],"topics":[],"urls":[],"subject_links":[]},"create_time":"2020-03-24 20:41:58","replies":[],"is_deleted":false,"id":"336915"},"from":"","author":{"kind":1000,"name":"ç§‹æ˜","url":"https:\/\/www.douban.com\/people\/nothinganymore\/","gender":"F","abstract":"So even if it feels like the whole world is against you, having just one person on your side can make a big difference.\n\nHey, ä¸ç®¡æˆ‘ä»¬è®¤ä¸è®¤è¯†ï¼Œå¦‚æœä½ çœ‹åˆ°è¿™å¥è¯äº†ï¼Œé‚£æˆ‘å¸Œæœ›ä½ çŸ¥é“ï¼Œä½ å·²ç»è¶³å¤Ÿå¥½äº†å‘€ï¼","avatar":"https://img9.doubanio.com\/icon\/up78857574-10.jpg","signature":"å†°ç«ä¸¤é‡å¤©","id":"78857574","uid":"nothinganymore"},"text":"æœçš„åˆ°çš„å•Šï¼Œhttps:\/\/b-ok.cc\/book\/960193\/5ad0a1 å°±æ˜¯ä»æœç´¢ç»“æœä¸­æ‰¾åˆ°çš„","total_replies":0,"entities":{"user_mentions":[],"topics":[],"urls":[{"indices":[6,40],"url":"https:\/\/b-ok.cc\/book\/960193\/5ad0a1","expanded_url":"https:\/\/b-ok.cc\/book\/960193\/5ad0a1"}],"subject_links":[]},"create_time":"2020-03-24 22:53:29","replies":[],"is_deleted":false,"id":"336933"}],"is_deleted":false,"id":"336908"},{"is_folded":false,"has_ref":false,"ref_comment":null,"from":["è±†ç“£App","https:\/\/www.douban.com\/doubanapp\/"],"author":{"kind":1000,"name":"æ‚ æ€¡ç„¶","url":"https:\/\/www.douban.com\/people\/33912666\/","gender":null,"abstract":"æ‰¾åˆ°è‡ªå·±çš„è·¯ã€‚","avatar":"https://img9.doubanio.com\/icon\/up33912666-6.jpg","signature":"","id":"33912666","uid":"33912666"},"text":"ä¸å¥½æ„æ€å‘€ï¼Œæˆ‘å»é¸ æ‘©æœäº†ï¼Œæ²¡æœ‰æ‰¾åˆ°ã€‚è¯·é—®ä½ è¿˜ä¿å­˜çš„æœ‰å—ï¼Œå¦‚æœå¯ä»¥èƒ½å¤Ÿåˆ†äº«ç»™æˆ‘å—ï¼Ÿ","total_replies":0,"entities":{"user_mentions":[],"topics":[],"urls":[],"subject_links":[]},"create_time":"2020-03-24 20:50:52","replies":[],"is_deleted":false,"id":"336916"}],
        'total': 5,
        'start': 0,
        'count': 100,
        'user': {"intro":"","is_admin":false,"uid":"252269522","signature":"","url":"https:\/\/www.douban.com\/people\/252269522\/","gender":"","can_delete_all_comments":false,"id":"252269522","avatar":"https://img9.doubanio.com\/icon\/user_large.jpg","name":"è±†å‹252269522"},
        'author': {"intro":"So even if it feels like the whole world is against you, having just one person on your side can make a big difference.\n\nHey, ä¸ç®¡æˆ‘ä»¬è®¤ä¸è®¤è¯†ï¼Œå¦‚æœä½ çœ‹åˆ°è¿™å¥è¯äº†ï¼Œé‚£æˆ‘å¸Œæœ›ä½ çŸ¥é“ï¼Œä½ å·²ç»è¶³å¤Ÿå¥½äº†å‘€ï¼","uid":"nothinganymore","is_friend":false,"signature":"å†°ç«ä¸¤é‡å¤©","url":"https:\/\/www.douban.com\/people\/nothinganymore\/","gender":"F","id":"78857574","avatar":"https://img9.doubanio.com\/icon\/up78857574-10.jpg","name":"ç§‹æ˜"},
        'target': {"kind":3049,"reply_limit":"A","id":"90074532","can_add_comment":true},
        'options': {
            'only_comment_at_the_end_of_pages': true,
            'enable_comment_sync_to_status': true,
            'bg_color': '#f8f8f4',
            'report_type': 'comment',
        },
        'reportType': 'comment',
        'needEscape': true
    }
</script>
<script src="https://img9.doubanio.com/f/book/800c78874aabeb5194255595b4474647e59f703a/js/book/comments/dist/comments.js"></script>

</div>
      <div class="aside">
        
  
      <fieldset class="pl" style="display:none">
    <legend>ä»…ç®¡ç†å‘˜å¯è§</legend>
    
  
    <script type="text/javascript" src="https://hyjal.dapps.douban.com/raikiri/raikiri.js"></script>
    </fieldset>



<p class="pl2">&gt; <a href="javascript:void(0)">ç§‹æ˜çš„æ‰€æœ‰ç¬”è®°ï¼ˆ56ç¯‡ï¼‰</a></p>







<div class="disclaimer">
  
  

  <h2>
    <span>è¯´æ˜</span>
      &nbsp;Â·&nbsp;Â·&nbsp;Â·&nbsp;Â·&nbsp;Â·&nbsp;Â·

  </h2>


  <p class="pl">
    
    è¡¨ç¤ºå…¶ä¸­å†…å®¹æ˜¯å¯¹åŸæ–‡çš„æ‘˜æŠ„
  </p>
</div>

<!-- douban ad begin -->
<div id="dale_book_annotation_top_right"></div>
<!-- douban ad end -->

      </div>
      <div class="extra">
        

      </div>
    </div>
  </div>

        
  

    </div>
      

    <script type="text/javascript" src="https://img9.doubanio.com/misc/mixed_static/46dee2ce0e3cc360.js"></script><script type="text/javascript">
(function(){
    window.collect_target = {
        tkind: "3049",
        tid: "90074532"
    }
    window.update_collect_state = function(collected){
        var ele = document.querySelector('.lnk-doulist-add');
        var old_num = parseInt(ele.querySelector('.react-num').textContent);
        ele.className = 'lnk-doulist-add';
        if(collected){
            ele.className += ' collect-cancel';
            ele.querySelector('.react-text').textContent = 'å·²æ”¶è—';
            ele.querySelector('.react-num').textContent = isNaN(old_num) ? 1 : old_num + 1;
        }else{
            ele.className += ' collect-add';
            ele.querySelector('.react-text').textContent = 'æ”¶è—';
            ele.querySelector('.react-num').textContent = isNaN(old_num) ? "" : old_num - 1 === 0 ? "" : old_num - 1;
        }
    }
})();
function deferred(){var e={done:[],fail:[]},t={done:function(o){return e.done.push(o),t},fail:function(o){return e.fail.push(o),t}};return{resolve:function(){for(var t,o=0;t=e.done[o++];)t.apply(this,arguments)},reject:function(){for(var t,o=0;t=e.fail[o++];)t.apply(this,arguments)},promise:t}}var loader=function(e,t,o,r,n,a){if(e){"function"==typeof t&&(r=t,t=""),"function"==typeof o&&(r=o,o="");var i=function(){loader.loaded[e]=1,r&&r(e),r=null,clearTimeout(d)};if(loader.loaded[e])return loader.loading[e]&&(loader.loading[e]=0),void setTimeout(function(){i()},0);if(loader.loading[e])return void setTimeout(function(){loader(e,t,o,r,n,a)},10);loader.loading[e]=1;var l,d=setTimeout(function(){try{a(e)}catch(e){}},n||6e3),s=t||e.toLowerCase().split(/\./).pop().replace(/[\?#].*/,"");"js"===s?(l=document.createElement("script"),l.setAttribute("type","text/javascript"),l.setAttribute("src",e),l.setAttribute("async",!0)):"css"===s&&(l=document.createElement("link"),l.setAttribute("type","text/css"),l.setAttribute("rel","stylesheet"),l.setAttribute("href",e)),o&&(l.charset=o),"css"===s?setTimeout(function(){i()},0):(l.onerror=function(){i(),l.onerror=null},l.onload=l.onreadystatechange=function(){this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState||(setTimeout(function(){i()},0),l.onload=l.onreadystatechange=null)});var c=function(){var e=document.getElementsByTagName("script");return e[e.length-1]}();c.parentNode.insertBefore(l,c)}};loader.loaded=window.__external_files_loaded=window.__external_files_loaded||{},loader.loading=window.__external_files_loading=window.__external_files_loading||{},loader.batch=function(){if(0!=arguments.length){var e=Array.prototype.slice.call(arguments);"[object Array]"==Object.prototype.toString.call(e[0])&&(e=e[0]);for(var t,o=deferred(),r=[],n=function(){r.pop(),0===r.length&&o.resolve()},a=0;t=e[a++];)r.push(t),loader(t,n);return o.promise}};
Do(function() {
  loader.batch([
    'https://img9.doubanio.com/f/shire/8377b9498330a2e6f056d863987cc7a37eb4d486/css/ui/dialog.css',
    'https://img9.doubanio.com/f/shire/bc881a837a728ab82aa01d653b1c180190bb5a5d/js/ui/dialog.js'
  ]).done(function() {
    var encodeHTML = function(s) {
    return s.replace(/\&/g, '&amp;')
            .replace(/\"/g, '&quot;')
            .replace(/\'/g, '&apos;')
            .replace(/\</g, '&lt;')
            .replace(/\>/g, '&gt;');
};

function deferred() {
  var callbacks = {
    done: [],
    fail: []
  };

  var promise = {
    done: function(callback) {
      callbacks.done.push(callback);
      return promise;
    },

    fail: function(callback) {
      callbacks.fail.push(callback);
      return promise;
    }
  };

  return {
    resolve: function() {
      var i = 0, cb;
      for(;cb = callbacks['done'][i++];) {
        cb.apply(this, arguments);
      }
    },

    reject: function() {
      var i = 0, cb;
      for(;cb = callbacks['fail'][i++];) {
        cb.apply(this, arguments);
      }
    },

    promise: promise 
  };
}
;
function asyncRequest(url, params, method) {
  var defer = deferred();
  var xhr = null;
  var t = (method || 'get').toLowerCase();
  xhr = $.ajax({
    url: url,
    type: t, 
    dataType: 'json',
    data: (t === 'post')? $.extend(params, {ck: get_cookie('ck')}) : params,
    error: function(e) {
      defer.reject(e);
    },
    success: function(e) {
      defer.resolve(e);
    }
  });

  defer.promise.abort = function() {
    xhr && xhr.abort();
  }
  return defer.promise;
}
;
var DOULIST_ADDITEM = '/j/doulist/{doulist_id}/additem';
var DOULIST_REMOVEITEM = '/j/doulist/{doulist_id}/removeitem';
var DOULIST_EDITITEM = '/j/doulist/{doulist_id}/edititem';
var DOULIST_COMMENT = '/j/doulist/{doulist_id}/poke';
var DOULIST_CREATE = '/j/doulist/add';
var DOULIST_LIST = '/j/doulist/cat';
var DOULIST_SEARCH = '/j/doulist/search';
var DOULIST_SEARCH_SELF = '/j/doulist/search_user_doulists';
var DOULIST_GET_ITEM_INFO = '/j/doulist/get_item_info';
var SUBJECT_DOULIST_LIST = '/j/doulist/subject_doulists'; // ç‰‡å•|ä¹¦å•
;
var validateForm = function(frm, rules) {
  var bool = true;
  var inp;
  for (var n in rules) {
    if (rules.hasOwnProperty(n)) {
      inp = frm.find(n);
      bool = rules[n](inp);
      if (bool) {
        validateForm.cleanError(inp);
      }
    }
  }
  return bool;
};

validateForm.displayError = function(inp, error) {
  if (!inp) {
    return;
  }
  var item = inp.closest('.item');
  var errorNode = item.find('.form-field-error');
  if (errorNode.length === 0) {
    errorNode = $('<div class="form-field-error"></div>').prependTo(item);
  }
  errorNode.show().html(error);
};

validateForm.cleanError = function(inp) {
  inp.closest('.item').find('.form-field-error').hide();
};



function doulistCustomeEvents(dialog) {
  var cancelBtn = dialog.node.find('.bn-cancel');
  dialog.node.bind('dialog-error', function(e, error) {
    dialog.setContent(
      '<div class="doulist-submit-success"><p>' + error + '</p>\
         <div class="item-submit">\
           <span class="bn-flat"><input type="button" value="å…³é—­" class="bn-cancel"></span>\
         </div>\
       </div>\
      '
    ).update();
    cancelBtn.click(function() {
      dialog.close();
    });
    setTimeout(function() {
      dialog.close();
    }, 3000);
  });

  dialog.node.bind('dialog-success', function(e, doulist) {
    title = doulist.__title || "æ·»åŠ æˆåŠŸ"
    action = doulist.__action || 'å·²ç»æ·»åŠ åˆ°<a href="' + doulist.url + '" target="_blank"> ' + doulist.name + '</a>';
    dialog.setTitle(title).setContent(
      '<div class="doulist-submit-success">\
         <i></i>' + action + '\
         <div>\
           <p>çª—å£å°†åœ¨<b class="num">3</b>ç§’åå…³é—­</p>\
           <span class="bn-flat"><input type="button" value="å…³é—­" class="bn-cancel"></span>\
         </div>\
       </div>\
      '
    );
    cancelBtn = dialog.node.find('.bn-cancel');
    cancelBtn.click(function() {
      dialog.close();
      timer && clearTimeout(timer);
    });
    var num = dialog.node.find('.num')
      , count = num.text()
      , countdown, timer
    ;(function() {
      countdown = countdown || arguments.callee;
      timer = setTimeout(function() {
        num.text(--count);
        count? countdown(): dialog.close();
      }, 1000);
    })();
  });
}
;
var doulistDialogForm = typeof doulistDialogForm === 'undefined'? {} : doulistDialogForm

;(function() {
  var initForm = function(dialog) {
    var frm = dialog.node.find('form');

    frm.submit(function(e){
      e.preventDefault();
      var frmData = {
        subjectId: frm.find('input[name=subject_id]').val(),
        subjectKind: frm.find('input[name=subject_kind]').val(),
        subjectUrl: frm.find('input[name=subject_url]').val(),
        subjectIsUrlSubject: frm.find('input[name=subject_is_url_subject]').val() == "true",
        comment: frm.find('textarea[name="comment"]').val(),
        sync: frm.find('#dlg-opt-share').attr('checked')? '1': ''
      };
      existListHandler(dialog, frm, frmData)
        .bind('form-submit-error', function(e, error) {
          dialog.node.trigger('dialog-error', error);
        })
        .bind('form-submit-success', function(e, doulist) {
          dialog.node.trigger('dialog-success', doulist);
        })
    });
    frm.bind('form-submit-fail', function(e, msg){
      validateForm.displayError(frm.find('input[name=dl_title]'), msg);
    });
    doulistCustomeEvents(dialog);
  }

  function existListHandler(dialog, frm, frmData) {
    var doulistSelect = frm.find('input[name=dl_id]:checked');
    var doulistId = doulistSelect.val();
    var doulistName = doulistSelect.next().find('b').text();
    var validateRules = {
      '.dl_exist_select input:checked': function(e) {
        if (!e.length) {
          validateForm.displayError($('.dl_exist_select'), 'è¯·é€‰æ‹©ä¸€ä¸ªè±†åˆ—');
          return false;
        }
        return true;
      }
    }
    if(!doulistId && window.hasCancelCollectAction === true){
      var obj = {
        __title: "å–æ¶ˆæ”¶è—æˆåŠŸ",
        __action: "å·²ç»å–æ¶ˆäº†æ”¶è—"
      }
      setTimeout(function(){
        frm.trigger('form-submit-success', obj);
      }, 500)
      window.update_collect_state && window.update_collect_state(false);
      window.hasCancelCollectAction = null;
      return frm;
    }
    if (validateForm(frm, validateRules)) {
      var data = {
        /* local-dev
        // sid: '25839662', // movie
        // sid: '24879016', // book
        */
        sid: frmData.subjectId,
        skind: frmData.subjectKind,
        comment: frmData.comment,
        sync_to_mb: frmData.sync
      }
      if(frmData.subjectIsUrlSubject){
        data.surl = frmData.subjectId
        delete data.sid
        delete data.skind
      }
      asyncRequest(
        DOULIST_ADDITEM.replace('{doulist_id}', doulistId),
        data,
        'post'
      ).done(function(res) {
        if (res.r) {
          frm.trigger('form-submit-error', res.err);
          return;
        }

        res.sid = frmData.subjectId;
        res.doulist_id = doulistId;
        res.name = $.trim(encodeHTML(doulistName));

        window.update_collect_state && window.update_collect_state(true);
        frm.trigger('form-submit-success', res);
      });
    }
    return frm;
  }

  doulistDialogForm.initForm = initForm;
})()
;
// ref: docs/widgets/doulist_btn.html

;(function($){
var current_doulist_dialog;

window.hasCancelCollectAction = null;

var params = window.collect_target || {};
if (!params.limit) {
  params.limit = 10;
}
params.start = 0;

/* local-dev */
// params.tkind = '1001'
// params.tid = '33387422'

var pureDoulistParams = {
  tkind: params.tkind,
  tid: params.tid,
  start: 0,
  limit: params.limit
};

var searchParams = {
  start: 0,
  limit: params.limit
}

var total;
var pureDoulistTotal;
var searchDoulistTotal;
var status = '';
var pureDoulistStatus = '';
var searchDoulistStatus = '';
var allSubjectDoulsitLoaded = false;
var searchKeyword = ''
var noMoreSearchResult = false;
var inputLock = false;

var DOULIST_ITEM_TMPL = '\
  <div class="dl-item-wrap"\
   data-category="{{category}}"\
   data-doulist-type="{{doulist_type}}"\
   data-is-syncing-from-note="{{is_syncing_from_note}}"\
   data-sync-note-id="{{sync_note_id}}">\
    <input type="radio" value="{{id}}" id="{{id}}" name="dl_id"> \
    <label for="{{id}}"> \
      <span>{{count}}</span> \
      <b data-is-private="{{is_private}}"> \
        <i data-id="{{id}}" data-name="{{name}}" data-is-collected="{{is_collected}}" class="cancel-collect-btn"></i> \
        {{name}} \
      </b> \
    </label> \
  </div>';
var loader = '<div class="loading" style="float: none; width: auto; margin: 4px; background-position: center center;"></div>';

function debounce(func, wait, immediate) {
  var timeout;
  return function() {
    var context = this, args = arguments;
    var later = function() {
      timeout = null;
      if (!immediate) func.apply(context, args);
    };
    var callNow = immediate && !timeout;
    clearTimeout(timeout);
    timeout = setTimeout(later, wait);
    if (callNow) func.apply(context, args);
  };
};

var DOULIST_CATEGORY_TEXT = {
  'movie': 'ç‰‡å•',
  'tv': 'ç‰‡å•',
  'book': 'ä¹¦å•'
}

function getDigestTypeText(type) {
  var text = type && DOULIST_CATEGORY_TEXT[type] ? DOULIST_CATEGORY_TEXT[type] : '';
  return text;
}

function isStartsWithPrefixWord(str, type) {
  var separator = ['ï½œ', 'ä¸¨', '|']; // ä¸‰ç§ä¸åŒç±»å‹çš„åˆ†éš”ç¬¦
  return separator.some((sep) => {
    var reg = new RegExp('^' + getDigestTypeText(type) + "\\"  + sep);
    return reg.test(str);
  })
};

function DoulistDialog(node, config) {
  showDoulistDialog(config);
  node.trigger('dialog:show', current_doulist_dialog);

  getAllDoulist(config, function() {
    handleDoulist(config);
    handleNewDoulist(config);
    handleDoulistSearch(config);
    handleCancelCollect(config);
    handleSelectDoulist(config);
  });
  doulistDialogForm.initForm(current_doulist_dialog);
}

function showDoulistDialog(config) {
  if (current_doulist_dialog) {
    current_doulist_dialog.close();
  }
  config.picture = config.picture || '/pics/doulist_article.png';

  /* local-dev */
  // config.cate = '1001'

  var header = config.cate === '1001' ?
    '<h3>é€‰æ‹©ä¹¦å•</h3>\
    <input type="button" name="dl_choose" id="dl_new" autocomplete="off" class="lnk-flat" value="åˆ›å»ºä¹¦å•" />' :
    config.cate === '1002' ? 
    '<h3>é€‰æ‹©ç‰‡å•</h3>\
    <input type="button" name="dl_choose" id="dl_new" autocomplete="off" class="lnk-flat" value="åˆ›å»ºç‰‡å•" />' :
    '<h3>é€‰æ‹©è±†åˆ—</h3>\
    <input type="button" name="dl_choose" id="dl_new" autocomplete="off" class="lnk-flat" value="åˆ›å»ºè±†åˆ—" />';
  var title = config.cate === '1001' ? 'è¾“å…¥æ–°ä¹¦å•åç§°' : config.cate === '1002' ? 'è¾“å…¥æ–°ç‰‡å•åç§°' : 'è¾“å…¥æ–°è±†åˆ—åç§°'

  var dialog = current_doulist_dialog = dui.Dialog({
    title: config.cate === '1002' ? 'æ·»åŠ åˆ°ç‰‡å•' : config.cate === '1001' ? 'æ·»åŠ åˆ°ä¹¦å•' : 'æ”¶è—åˆ°è±†åˆ—',
    width: 640,
    cls: 'dialog-doulist',
    content:
      (config.canview === 'False' ?
        '<div class="doulist-ft" style="text-align:left;">å•Šï¼Œè¯¥å†…å®¹ä½ æ²¡æœ‰æƒé™æŸ¥çœ‹æˆ–å·²è¢«ä½œè€…åˆ é™¤ã€‚</div>' :
        '<form action="" method="post"><div style="display:none;"><input type="hidden" name="ck" value="nTrr"/></div>\
          <div class="doulist-bd">\
            <div class="doulist-preview">\
              <div><img src="{{picture}}" /></div>\
              <p class="item-title">{{title}}</p>\
            </div>\
            <div class="doulist-content">\
              <div class="item">\
                <div class="item-hd">\
                  <input type="text" name="search" class="dl_search" autocomplete="off" placeholder="è¯·è¾“å…¥è±†åˆ—åç§°" maxlength="40" />\
                  <a href="javascript: void 0;" class="clear_search">Ã—</a>' +
                  header +
                '</div>\
                <div class="dl-bd">\
                  <div class="dl-item">\
                    <div class="dl_new_title" style="display: none;">\
                      <div class="dl_title_block"> \
                        <input id="dl_title" type="text" class="basic-input dl-title" placeholder="' + title + '" maxlength="40" />\
                      </div> \
                      <div class="dl_action_block"> \
                        <div class="dl_create_option">\
                          <span>éšç§è®¾ç½®ï¼š</span> \
                          <input id="doulist_is_not_secret" type="radio" name="is_private" value="false" checked /> \
                          <label for="doulist_is_not_secret">æ‰€æœ‰äººå¯è§</label> \
                          <input id="doulist_is_secret" type="radio" name="is_private" value="true" /> \
                          <label for="doulist_is_secret">ä»…è‡ªå·±å¯è§</label> \
                        </div> \
                        <input type="button" class="lnk-flat dl_new_submit" disabled value="åˆ›å»º" />\
                      </div> \
                    </div>\
                  </div>\
                  <div class="dl-loading">\
                    åŠ è½½ä¸­...\
                  </div>\
                </div>\
              </div>\
              <div class="item">\
                <div class="item-hd">\
                  <h3>æ¨èè¯­<span>ï¼ˆé€‰å¡«ï¼‰</span></h3>\
                </div>\
                <textarea id="doulist_item_comment" class="basic-textarea" name="comment" placeholder="å‘Šè¯‰å¤§å®¶ä½ æ·»åŠ å®ƒçš„ç†ç”±å§"></textarea>\
              </div>\
              <input type="hidden" name="dl_cat" value="{{cate}}">\
              <input type="hidden" name="subject_id" value="{{id}}">\
              <input type="hidden" name="subject_kind" value="{{cate}}">\
              <input type="hidden" name="subject_url" value="{{url}}">\
              <input type="hidden" name="subject_is_url_subject" value="{{isurlsubject}}">\
              </div>\
            </div>\
            <div class="doulist-ft">\
              <a target="_blank" href="https://www.douban.com/service/bookmarklet" class="lnk-bookmarklet">å°å·¥å…·ï¼šä»æµè§ˆå™¨ç›´æ¥æŠŠç½‘é¡µå†…å®¹åŠ å…¥è±†åˆ—</a>\
              <span class="bn-flat cancel_btn"><input type="button" class="j_close_dialog" value="å–æ¶ˆ"></span>\
              <span class="bn-flat"><input type="submit" class="doulist_submit" value="ä¿å­˜"></span>\
            </div>\
        </form>\
      ').replace(/{{[^{}]+}}/g, function(match) {
        return (encodeHTML(config[match.replace(/[{}]/g, "")]+"").toString());
      })
    }, true).open();

  dialog.update();

  dialog.node.bind('dialog:close', function() {
    dialog.node.remove();
  });

  dialog.node.bind('dialog:change', function() {
    dialog.update();
  });

  // é‡ç½®ä¸€ä¸‹å„é¡¹å‚æ•°
  params.tkind = config.cate;
  params.tid = config.id;
  params.start = 0;
  pureDoulistParams.tkind = config.cate;
  pureDoulistParams.tid = config.id;
  pureDoulistParams.start = 0;
  searchParams.start = 0;

  status = '';
  pureDoulistStatus = '';
  searchDoulistStatus = '';
  allSubjectDoulsitLoaded = false;

  clearSearch();
}

// è·å–åŒ…å«ä¹¦å•ã€ç‰‡å•çš„å…¨éƒ¨è±†åˆ—
function getAllDoulist(config, callback) {
  if (config.cate === '1001') {
    getMixedDoulist('book', callback);
  } else if (config.cate === '1002') {
    getMixedDoulist('movie', callback);
  } else {
    getMixedDoulist('common', callback);
  }
}

// è·å–å·²æœ‰çš„ç‰‡å•/ä¹¦å•
function getMixedDoulist(category, callback) {
  var appendPureDoulists = function() {
    if (pureDoulistParams.start >= pureDoulistTotal || pureDoulistStatus === 'pending') {
      return;
    }

    pureDoulistStatus = 'pending';
    $('.dl_exist_select').append(loader);
    asyncRequest(DOULIST_LIST, {
      tkind: pureDoulistParams.tkind,
      tid: pureDoulistParams.tid,
      start: pureDoulistParams.start,
      limit: pureDoulistParams.limit
    })
    .done(function(pureDoulistResp) {
      var DL_TMPL = DOULIST_ITEM_TMPL;

      // ç›´æ¥è¯·æ±‚çº¯è±†åˆ—ï¼Œå¹¶ä¸”æ˜¯ç¬¬ä¸€æ¬¡åŠ è½½çš„æ—¶å€™
      if (pureDoulistParams.start === 0 && category === 'common') {
        if (pureDoulistResp.total) {
          var DL_STR = '<div class="dl_exist_select">';
          $(pureDoulistResp.doulist).each(function(i, dl) {
            DL_STR += DL_TMPL.replace(/{{[^{}]+}}/g, function(match) {
              var matched = dl[match.replace(/[{}]/g, "")];
              return matched && encodeHTML(matched.toString()) || "";
            });
          });
          DL_STR += '</div>';
          $('<div />', {'class': 'dl-item dl-item-exist'}).insertAfter($('.dl-item')).append(DL_STR);
        } else {
          $('<div />', {'class': 'dl-item dl-item-exist'}).insertAfter($('.dl-item')).append(
            '<div class="dl_exist_select"><div class="empty-list">è¿˜æœªåˆ›å»ºè±†åˆ—</div></div>'
          );
        }
      } else {
        var DL_STR = '';
        $(pureDoulistResp.doulist).each(function(i, dl) {
          DL_STR += DL_TMPL.replace(/{{[^{}]+}}/g, function(match) {
            var matched = dl[match.replace(/[{}]/g, "")];
            return matched && encodeHTML(matched.toString()) || "";
          });
        });
        $('.dl_exist_select').append(DL_STR);
      }

      pureDoulistParams.start = pureDoulistParams.start + pureDoulistParams.limit;
      pureDoulistTotal = pureDoulistResp.total;
      pureDoulistStatus = 'success';

      $('.dl-item-exist .loading').remove();

      settleDoulistItemStatus(category)

      var dialog = current_doulist_dialog;
      dialog.node.find('form #doulist_item_comment').val(pureDoulistResp.comment);

      if (pureDoulistParams.start >= pureDoulistTotal) {
        $('.dl_exist_select').append('<div style="padding: 14px 0; text-align: center; color: #666;">æ²¡æœ‰æ›´å¤šäº†</div>');
      }

      if (category === 'common') {
        callback && callback()
      }

    }).fail(function() {
      $('.dl-loading').text('+_+ åŠ è½½å¤±è´¥ï¼Œè¯·åˆ·æ–°é‡è¯•');
      pureDoulistStatus = 'error';
      $('.dl-item-exist .loading').remove();
    })
  }

  if (allSubjectDoulsitLoaded || category === 'common') {
    appendPureDoulists();
    return;
  }

  if (params.start >= total || status === 'pending') {
    return;
  }

  status = 'pending';
  $('.dl_exist_select').append(loader);

  asyncRequest(SUBJECT_DOULIST_LIST, {
    start: params.start + getJustCreatedNewListsCount(),
    limit: params.limit,
    tkind: params.tkind,
    tid: params.tid
  }).done(function(resp) {
    var DL_TMPL = DOULIST_ITEM_TMPL;

    // ç¬¬ä¸€æ¬¡åŠ è½½çš„æ—¶å€™
    if (params.start === 0) {
      if (resp.total) {
        var DL_STR = '<div class="dl_exist_select">';
        $(resp.doulist).each(function(i, dl) {
          DL_STR += DL_TMPL.replace(/{{[^{}]+}}/g, function(match) {
            var matched = dl[match.replace(/[{}]/g, "")];
            return matched && encodeHTML(matched.toString()) || "";
          });
        });
        DL_STR += '</div>';

        $('<div />', {'class': 'dl-item dl-item-exist'}).insertAfter($('.dl-item')).append(DL_STR);
      } else {
        var typeStr = category === 'book' ? 'ä¹¦å•' : category === 'movie' ? 'ç‰‡å•' : '';
        $('<div />', {'class': 'dl-item dl-item-exist'}).insertAfter($('.dl-item')).append(
          '<div class="dl_exist_select"><div class="empty-list">è¿˜æœªåˆ›å»º' + typeStr + '</div></div>'
        );
      }
    } else {
      var DL_STR = '';
      $(resp.doulist).each(function(i, dl) {
        DL_STR += DL_TMPL.replace(/{{[^{}]+}}/g, function(match) {
          var matched = dl[match.replace(/[{}]/g, "")];
          return matched && encodeHTML(matched.toString()) || "";
        });
      });

      $('.dl_exist_select').append(DL_STR);
    }

    $('.dl_new_title').hide();

    params.start = params.start + params.limit;
    total = resp.total;
    status = 'success';

    $('.dl-item-exist .loading').remove();

    settleDoulistItemStatus(category)

    var dialog = current_doulist_dialog;
    dialog.node.find('form #doulist_item_comment').val(resp.comment);

    callback && callback()

    // æ‹¿åˆ°å…¨éƒ¨çš„ç‰‡å•/ä¹¦å•åï¼Œå†å»è·å–çº¯è±†åˆ—
    if (params.start >= total) {
      allSubjectDoulsitLoaded = true;

      if (pureDoulistParams.start === 0) {
        $('.dl_exist_select').append('<div class="test" style="font-size: 15px; padding-top: 15px; margin: 10px 0; color: #666; border-top: 1px solid #DFDFDF; ">æ”¶è—åˆ°è±†åˆ—</div>')
      }

      appendPureDoulists()
    }
  }).fail(function() {
    $('.dl-loading').text('+_+ åŠ è½½å¤±è´¥ï¼Œè¯·åˆ·æ–°é‡è¯•');
    status = 'error';
    $('.dl-item-exist .loading').remove();
  });
}


// é’ˆå¯¹åˆ—è¡¨é‡Œå•ä¸ªè±†åˆ—åšä¿®æ”¹
function settleDoulistItemStatus(targetCategory, isSearch) {
  var dialog = current_doulist_dialog;
  var $items = isSearch ? dialog.node.find('.search-result-list .dl-item-wrap') : dialog.node.find('.dl_exist_select .dl-item-wrap');

  $items.each(function(e, doulist) {
    var $d = $(doulist);
    var doulist_category = $d.attr('data-category');
    var doulist_type = $d.attr('data-doulist-type');
    var is_syncing_from_note = $d.attr('data-is-syncing-from-note');
    var sync_note_id = $d.attr('data-sync-note-id');
    var is_collected = $d.find('.cancel-collect-btn').attr('data-is-collected');

    // å¦‚æœå·²ç»æ”¶è—è¿‡äº†ï¼Œä¸èƒ½å†é€‰æ‹©
    // if (is_collected) {
      // $d.find('input').attr('disabled', true)
    // }

    // ä¸èƒ½ç›´æ¥æ·»åŠ åˆ°æ¡ç›®è±†åˆ—
    if (is_syncing_from_note) {
      $d.find('input').attr('disabled', true);
    } 

    if (is_syncing_from_note && sync_note_id && targetCategory === doulist_category) {
        var act = is_collected ? 'å»ç§»é™¤' : 'å»æ·»åŠ ';
        $d.find('span').html('<a target="_blank" href="//www.douban.com/note/' + sync_note_id + '/edit">' + act + '&gt;</a>');
    }
  })
}

// è·å–é€šè¿‡å¼¹çª—æ–°å»ºçš„åˆ—è¡¨æ•°é‡ï¼Œç”¨æ¥åœ¨æ»šåŠ¨åŠ è½½æ—¶é‡æ–°è®¡ç®— start å€¼
function getJustCreatedNewListsCount() {
  var dialog = current_doulist_dialog;
  var dl_exist = $('.dl_exist_select');
  var count = 0;
  dl_exist.find('.dl-item-wrap').each(function(i, item) {
    if ($(item).hasClass('just-created')) {
      count++
    }
  })
  return count
}

function handleCancelCollect(config){
  var $cancelBtn = $('.cancel-collect-btn');
  $cancelBtn.click(function(e){
    e.stopPropagation();
    e.preventDefault();
    if (!confirm("ç¡®å®šè¦ç§»é™¤å—ï¼Ÿ")) return;

    var did = $(this).attr('data-id');
    var url = DOULIST_REMOVEITEM.replace('{doulist_id}', did);
    var param = window.collect_target || {};
    var $btn = $(this);
    param.ck = get_cookie('ck');
    param.tkind = config.cate;
    param.tid = config.id;
    asyncRequest(url, param, "post").done(function(res){
      if (res.r === 0) {
        $btn.attr('data-is-collected', 'false');
        $btn.closest('label').find('span').html('');
        var $root = $btn.closest('label').parent();
        $root.find('input[type="radio"]').get(0).checked = false;
        $root.find('input[type="radio"]').attr('disabled', false);
        $root.removeClass('checked_dl');
        window.hasCancelCollectAction = true;
      } else {
        alert("å–æ¶ˆæ”¶è—æ—¶é‡åˆ°äº†é”™è¯¯: " + res.err);
      }
    })
  });
}

function handleDoulist(config) {
  var dialog = current_doulist_dialog;
  var dl_new = $('#dl_new');
  var dl_new_title = $('.dl_new_title');
  var dl_title = $('#dl_title');
  var dl_exist = $('.dl-item-exist');
  var dl_id = $('#dl_id');

  dl_new.click(function() {
    var form_error = $('.form-field-error');
    if (dl_new_title.is(':hidden')) {
      form_error.show() && dl_new.val('å–æ¶ˆåˆ›å»º');
      dl_new_title.slideDown(function() {
        dl_exist.addClass('fold');
        dl_title.focus();
      });
    } else {
      var typeStr = config.cate === '1001' ? 'ä¹¦å•' : config.cate === '1002' ? 'ç‰‡å•' : 'è±†åˆ—';
      form_error.hide() && dl_new_title.hide() && dl_new.val('åˆ›å»º' + typeStr) && dl_exist.removeClass('fold');
    }
  });

  // æ»šåŠ¨åŠ è½½
  // stop page scrolling
  dl_exist.bind('scroll', debounce(function(e) {
    var scrollTop = $(this).scrollTop();
    var scrollHeight = $(this).height();
    var windowHeight = $(".dl_exist_select:visible").height();

    if (scrollTop + scrollHeight + 30 >= windowHeight) {
      e.preventDefault();
      if (dl_exist.find('.search-result-list').size() > 0 && searchDoulistStatus !== '') {
        searchDoulist(config, true)
      } else {
        getAllDoulist(config)
      }
    }
  }, 300));
}

function handleSelectDoulist(config) {
  var dialog = current_doulist_dialog;
  dialog.node.delegate(':radio', 'change', function() {
    var $t = $(this);
    // æ’é™¤ã€Œæ–°å»ºè±†åˆ—ã€ç‰‡å•ã€ä¹¦å•ã€è¡¨å•é‡Œçš„ã€Œæ‰€æœ‰äººå¯è§ã€ã€Œä»…è‡ªå·±å¯è§ã€
    if ($t.parents('.dl_create_option').size() > 0) {
      return;
    }
    var did = $t.val();
    var url = DOULIST_COMMENT.replace('{doulist_id}', did);

    // æ—¥è®°åŒæ­¥çš„è±†åˆ—ä¸å¯é€‰
    if ($t.parent().attr('data-is-syncing-from-note')) {
      return;
    }

    asyncRequest(
      url, {
        /* local-dev */
        // sid: '25839662', // movie
        // sid: '33387422', // book
        sid: config.id,
        skind: config.cate
      }
    ).done(function(e){
      dialog.node.find('form #doulist_item_comment').val(e.comment);
    }).fail(function(){
      // ignore
    });
  });
}

function handleNewDoulist(config) {
  var dialog = current_doulist_dialog;
  var dl_new_title = $('.dl_new_title');
  var dl_title = $('#dl_title');
  var dl_new_submit = $('.dl_new_submit');

  dl_title.bind('keyup change', function() {
    if ($.trim(dl_title.val()).length) {
      dl_new_submit.removeAttr('disabled');
    } else {
      dl_new_submit.attr('disabled', true);
    }
  });

  dl_title.bind('keydown', function(e) {
    if (e.keyCode === 13) {
      newListHandler(dialog, dl_new_title, config);
      return false;
    }
  });

  dl_new_submit.click(function() {
    newListHandler(dialog, dl_new_title, config);
  });
}

function renderSearched(res, category) {
  var DL_TMPL = DOULIST_ITEM_TMPL;
  DL_TMPL = DL_TMPL.replace(/value="{{id}}" id="{{id}}"/g, 'value="{{id}}" id="search-{{id}}"').replace(/for="{{id}}"/g, 'for="search-{{id}}"');
  var RESULT = '';
  $(res.doulists).each(function(i, dl) {
    RESULT += DL_TMPL.replace(/{{[^{}]+}}/g, function(match) {
      var matched = dl[match.replace(/[{}]/g, "")];
      return matched && encodeHTML(matched.toString()) || "";
    });
  });

  $('.dl-item-exist .search-result-list').append(RESULT);

  settleDoulistItemStatus(category, true)
}

function handleDoulistSearch(config) {
  var dl_search = $('.dl_search');
  var dl_exist = $('.dl-item-exist');
  var dl_new_title = $('.dl_new_title');
  var dl_new = $('#dl_new');
  var clear_search_btn = $('.clear_search');

  clear_search_btn.click(function() {
    dl_search.val('').change();
    clearSearch()
  });

  dl_search.focus(function() {
    $(this).addClass('expand');
    if (!dl_new_title.is(':hidden')) {
      var form_error = $('.form-field-error');
      var typeStr = config.cate === '1001' ? 'ä¹¦å•' : config.cate === '1002' ? 'ç‰‡å•' : 'è±†åˆ—';
      form_error.hide() && dl_new_title.hide() && dl_new.val('åˆ›å»º' + typeStr) && dl_exist.removeClass('fold');
    }
  });

  dl_search.bind({
    'compositionstart': function () {
        inputLock = true;
    },
    'compositionend': function () {
        inputLock = false;
    },
    'input': function () {
      setTimeout(() => {
        if (inputLock) return;

        var currenKeyword = $.trim(dl_search.val());
        if (currenKeyword.length && searchKeyword !== currenKeyword) {
          noMoreSearchResult = false;
          searchDoulist(config);
        } else if (currenKeyword.length === 0) {
          clearSearch();
        }
      }, 100);
    }
  })
}

function clearSearch() {
  var dl_search = $('.dl_search');
  var dl_exist = $('.dl-item-exist');
  var clear_search_btn = $('.clear_search');

  $('.no-match-warning').hide();
  dl_exist.find('.dl_exist_select').show();
  dl_exist.find('.search-result-list').remove();
  searchParams.start = 0;
  searchDoulistTotal = null;
  searchDoulistStatus = '';
  // dl_exist.children().show();
  clear_search_btn.hide();
  dl_search.val('');
  searchKeyword = '';
  currenKeyword = '';
  noMoreSearchResult = false;
}

function show_no_match() {
  var dl_exist = $('.dl-item-exist');
  $('.no-match-warning').length ? $('.no-match-warning').show() : dl_exist.before('<p class="no-match-warning">æ²¡æœ‰æ‰¾åˆ°åŒ¹é…ç»“æœï¼Œå¯ä»¥æ¢ä¸ªå…³é”®è¯è¯•è¯•</p>');
}

function searchDoulist(config, isScrollAppend) {
  var promise = null;
  var dl_search = $('.dl_search');
  var dl_exist = $('.dl-item-exist');
  var dl_new_title = $('.dl_new_title');
  var dl_new = $('#dl_new');
  var clear_search_btn = $('.clear_search');

  var currenKeyword = $.trim(dl_search.val());

  if (promise) {
    promise.abort();
  }
  if (searchDoulistStatus === 'pending' || noMoreSearchResult) {
    return
  }

  $('.no-match-warning').hide();
  if (!isScrollAppend) {
    dl_exist.find('.search-result-list').remove();
  }

  clear_search_btn.hide();
  dl_search.addClass('loading');
  searchKeyword = currenKeyword;
  searchDoulistStatus = 'pending';
  const category = config.cate === '1001' ? 'book' : config.cate === '1002' ? 'movie' : '';

  promise = asyncRequest(
    DOULIST_SEARCH_SELF,
    {
      'limit': 5,
      'start': isScrollAppend ? searchParams.start : 0,
      'q': currenKeyword,
      'category': category
    }
  );
  promise.done(function(res) {
    dl_search.removeClass('loading');
    clear_search_btn.show();
    searchDoulistStatus = 'success';
    if (isScrollAppend) {
      searchParams.start = searchParams.start + searchParams.limit
    }

    if (res && res.doulists && res.doulists.length > 0) {
      if ($('.dl-item-exist .search-result-list').size() === 0) {
        $('.dl-item-exist .dl_exist_select').hide().after('<div class="search-result-list dl_exist_select"></div>')
      }
      renderSearched(res, category)
    } else {
      noMoreSearchResult = true;
      if (searchParams.start === 0) {
        dl_exist.find('.dl_exist_select').hide();
        dl_exist.find('.search-result-list').remove();
        show_no_match();
      } else {
        dl_exist.find('.search-result-list').append('<div style="padding: 14px 0; text-align: center; color: #666;">æ²¡æœ‰æ›´å¤šäº†</div>');
      }
    }
  }).fail(function() {
    noMoreSearchResult = true;
    dl_exist.find('.dl_exist_select').hide();
    dl_exist.find('.search-result-list').remove();
    show_no_match();
    dl_search.removeClass('loading');
    clear_search_btn.show();
    searchDoulistStatus = 'error';
  });
}

// è¡¨å•éªŒè¯ï¼ˆåˆ›å»ºè±†åˆ—/ç‰‡å•/ä¹¦å•æ—¶ï¼‰
function newListHandler(dialog, wrap, config) {
  var DL_TMPL = '<div class="just-created dl-item-wrap"><input type="radio" value="{{id}}" id="{{id}}" name="dl_id" checked="checked"><label for="{{id}}"><b data-is-private="{{is_private}}">{{name}}</b></label></div>';
  var dl_title = $('#dl_title');
  var dl_new = $('#dl_new');
  var dl_exist = $('.dl_exist_select');
  var validateRules = {
    '#dl_title': function(e) {
      if (e.val() === '') {
        var typeStr = config.cate === '1001' ? 'ä¹¦å•' : config.cate === '1002' ? 'ç‰‡å•' : 'è±†åˆ—';
        validateForm.displayError(e, 'è¯·ç»™ä½ çš„' + typeStr + 'èµ·ä¸€ä¸ªåç§°');
        return false;
      }
      return true;
    }
  }
  if (validateForm(wrap, validateRules)) {
    var dl_new_submit = $('.dl_new_submit');
    dl_new_submit.attr('disabled', true);
    var title = $.trim($('#dl_title').val());
    var digestType = config.cate === '1001' ? 'book' : config.cate === '1002' ? 'movie' : '';
    var prefixWord = getDigestTypeText(digestType) + 'ï½œ';

    // å¦‚æœæ˜¯ä¹¦å•ã€ç‰‡å•ï¼Œæ ‡é¢˜è‡ªåŠ¨åŠ ä¸Šå‰ç¼€
    if (digestType && !isStartsWithPrefixWord(title, digestType)) {
      title = prefixWord + title
    }

    var params = {
      title: title,
      is_private: $('input[name="is_private"]:checked').val(),
    }

    if (config.cate === '1001' || config.cate === '1002') {
      params.category = config.cate === '1001' ? 'book' : 'movie';
    }
    asyncRequest(DOULIST_CREATE, params, 'post')
      .done(function(res) {
        if (res.r) {
          alert(res.err);
          return;
        }

        res.doulist_id = res.id;
        var DL_STR = DL_TMPL.replace(/{{[^{}]+}}/g, function(match) {
          var matched = res[match.replace(/[{}]/g, "")];
          return matched && encodeHTML(matched.toString()) || "";
        });
        var new_dl = $(DL_STR);
        new_dl.prependTo(dl_exist);
        dl_exist.find('.empty-list').remove();

        dl_exist.animate({'scrollTop': 0}, 100);
        dl_new.click();
        dl_title.val('').change();
      })
      .fail(function() {
        alert('ç½‘ç»œé—®é¢˜ï¼Œè¯·ç¨åé‡è¯•');
        dl_new_submit.removeAttr('disabled');
      });
  } else {
    dialog.update();
  }
  return wrap;
}

$.fn.doulistDialog = function(options) {
  /* local-dev */
  // options.cate = "1001"
  // options.catename =  "å›¾ä¹¦"
  // options.id = "33387422"

  return new DoulistDialog($(this), options);
};

})(jQuery);


    $(document).delegate('.lnk-doulist-add', 'click', function(e) {
      e.preventDefault();
      if(window._USER_ABNORMAL) {
          show_abnormal && show_abnormal()
          return
      }
      var self = $(this);
      var param = $.extend({'url':''}, $(this).data(), {link: this.href});
      // å…¼å®¹jquery 1.8.x
      var newParam = {};
      for (var key in param) {
        if (typeof param[key] === 'number') {
          param[key] = self.attr('data-'+key);
        }
        if (param.hasOwnProperty(key)) {
          newParam[$.camelCase(key)] = param[key];
        }
      }
      self.doulistDialog(newParam);
    });

  });
});
</script><script type="text/javascript" src="https://img9.doubanio.com/misc/mixed_static/416715aca8677bae.js"></script>
    <!-- mako -->
    
<script type="text/javascript">
function hide_readonly_form(){
    $("#readonly_form").hide();
    return false;
}
$(function(){
    $(document).delegate(".set_readonly_p", "click", function() {
        $("#readonly_form").slideDown();
        return false;
    });
    $("pre.source").each(function(){
        var cn = $(this).attr('class').split(' ');
        l = cn[1];
        s = 'rand01';
        n = cn[2];
        $(this).snippet(n,{style: s, showNum: l});
    });
    $('#note_tooltip').tooltip();
});
</script>
<script src="https://img9.doubanio.com/f/shire/bc881a837a728ab82aa01d653b1c180190bb5a5d/js/ui/dialog.js"></script>
<script src="https://img9.doubanio.com/f/shire/ab240efa59e09be0533b108a1731e09e2a782e29/js/abnormal_account.js"></script>






    
<script type="text/javascript">
    (function (global) {
        var newNode = global.document.createElement('script'),
            existingNode = global.document.getElementsByTagName('script')[0],
            adSource = '//erebor.douban.com/',
            userId = '252269522',
            browserId = '1S50d3rycE8',
            criteria = '3:/annotation/90074532/',
            preview = '',
            debug = false,
            adSlots = ['dale_book_annotation_top_right'];

        global.DoubanAdRequest = {src: adSource, uid: userId, bid: browserId, crtr: criteria, prv: preview, debug: debug};
        global.DoubanAdSlots = (global.DoubanAdSlots || []).concat(adSlots);

        newNode.setAttribute('type', 'text/javascript');
        newNode.setAttribute('src', '//img1.doubanio.com/MnJwNGlleS9mL2FkanMvY2M1OGQyNTQ2N2I2YmQzOTlmNTliMGJiMjI4MWRhZTlkNTNjYTFkZC9hZC5yZWxlYXNlLmpz');
        newNode.setAttribute('async', true);
        existingNode.parentNode.insertBefore(newNode, existingNode);
    })(this);
</script>











    
  

<script type="text/javascript">
  var _paq = _paq || [];
  _paq.push(['trackPageView']);
  _paq.push(['enableLinkTracking']);
  (function() {
    var p=(('https:' == document.location.protocol) ? 'https' : 'http'), u=p+'://fundin.douban.com/';
    _paq.push(['setTrackerUrl', u+'piwik']);
    _paq.push(['setSiteId', '100001']);
    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0]; 
    g.type='text/javascript';
    g.defer=true; 
    g.async=true; 
    g.src=p+'://s.doubanio.com/dae/fundin/piwik.js';
    s.parentNode.insertBefore(g,s);
  })();
</script>

<script type="text/javascript">
var setMethodWithNs = function(namespace) {
  var ns = namespace ? namespace + '.' : ''
    , fn = function(string) {
        if(!ns) {return string}
        return ns + string
      }
  return fn
}

var gaWithNamespace = function(fn, namespace) {
  var method = setMethodWithNs(namespace)
  fn.call(this, method)
}

var _gaq = _gaq || []
  , accounts = [
      { id: 'UA-7019765-1', namespace: 'douban' }
    , { id: 'UA-7019765-16', namespace: '' }
    ]
  , gaInit = function(account) {
      gaWithNamespace(function(method) {
        gaInitFn.call(this, method, account)
      }, account.namespace)
    }
  , gaInitFn = function(method, account) {
      _gaq.push([method('_setAccount'), account.id])

      
  _gaq.push([method('_addOrganic'), 'google', 'q'])
  _gaq.push([method('_addOrganic'), 'baidu', 'wd'])
  _gaq.push([method('_addOrganic'), 'soso', 'w'])
  _gaq.push([method('_addOrganic'), 'youdao', 'q'])
  _gaq.push([method('_addOrganic'), 'so.360.cn', 'q'])
  _gaq.push([method('_addOrganic'), 'sogou', 'query'])
  if (account.namespace) {
    _gaq.push([method('_addIgnoredOrganic'), 'è±†ç“£'])
    _gaq.push([method('_addIgnoredOrganic'), 'douban'])
    _gaq.push([method('_addIgnoredOrganic'), 'è±†ç“£ç½‘'])
    _gaq.push([method('_addIgnoredOrganic'), 'www.douban.com'])
  }

      if (account.namespace === 'douban') {
        _gaq.push([method('_setDomainName'), '.douban.com'])
      }

        _gaq.push([method('_setCustomVar'), 1, 'responsive_view_mode', 'desktop', 3])

        _gaq.push([method('_setCustomVar'), 2, 'login_status', '1', 2]);

      _gaq.push([method('_trackPageview')])
    }

for(var i = 0, l = accounts.length; i < l; i++) {
  var account = accounts[i]
  gaInit(account)
}


;(function() {
    var ga = document.createElement('script');
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    ga.setAttribute('async', 'true');
    document.documentElement.firstChild.appendChild(ga);
})()
</script>








    <!-- dae-web-book--default-7db554f74f-mkk6m-->







































</body></html>